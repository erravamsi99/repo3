(()=>{var R=Object.defineProperty,W=Object.defineProperties;var $=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var j=(e,d,o)=>d in e?R(e,d,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[d]=o,q=(e,d)=>{for(var o in d||(d={}))B.call(d,o)&&j(e,o,d[o]);if(J)for(var o of J(d))F.call(d,o)&&j(e,o,d[o]);return e},z=(e,d)=>W(e,$(d));var X=(e,d,o)=>new Promise((s,b)=>{var m=t=>{try{i(o.next(t))}catch(a){b(a)}},r=t=>{try{i(o.throw(t))}catch(a){b(a)}},i=t=>t.done?s(t.value):Promise.resolve(t.value).then(m,r);i((o=o.apply(e,d)).next())});var H="WebPixel::Render";var y=e=>shopify.extend(H,e);var G="https://app.uppush.io",k=`${G}/api/customer-activity/track`;y(b=>X(void 0,[b],function*({analytics:e,browser:d,init:o,settings:s}){let m=yield d.localStorage.getItem("pushup_subscriber"),r=m?JSON.parse(m||""):null;r!=null&&r.customerId&&(e.subscribe("page_viewed",t=>{let a=t.context.document.location.href;a.includes("/checkout")||a.includes("/products")||fetch(k,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identifier:s.storeId,shop:o.data.shop.myshopifyDomain,customer:r.customerId,type:"Viewed page",clientId:t.clientId,pageTitle:t.context.document.title,pageUrl:t.context.document.location.href}),keepalive:!0})}),e.subscribe("product_viewed",t=>{t.data.productVariant&&fetch(k,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identifier:s.storeId,shop:o.data.shop.myshopifyDomain,customer:r.customerId,type:"Viewed product",clientId:t.clientId,pageTitle:t.context.document.title,pageUrl:t.context.document.location.href,productViewed:{productId:t.data.productVariant.product.id,variantId:t.data.productVariant.id,price:t.data.productVariant.price.amount,productTitle:t.data.productVariant.product.title,sku:t.data.productVariant.sku,vendor:t.data.productVariant.product.vendor}}),keepalive:!0})}),e.subscribe("product_added_to_cart",t=>{var a,u,p,n,h,l;t.data.cartLine&&fetch(k,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identifier:s.storeId,shop:o.data.shop.myshopifyDomain,customer:r.customerId,type:"Added product to cart",clientId:t.clientId,pageTitle:t.context.document.title,pageUrl:t.context.document.location.href,productAddedToCart:{productId:((a=t.data.cartLine)==null?void 0:a.merchandise.product.id)||"",variantId:((u=t.data.cartLine)==null?void 0:u.merchandise.id)||"",price:((p=t.data.cartLine)==null?void 0:p.cost.totalAmount.amount)||0,productTitle:(n=t.data.cartLine)==null?void 0:n.merchandise.product.title,sku:((h=t.data.cartLine)==null?void 0:h.merchandise.sku)||"",vendor:((l=t.data.cartLine)==null?void 0:l.merchandise.product.vendor)||""}}),keepalive:!0})}));let i=t=>{var a,u,p,n,h,l,f,g,I,T,S,_,x,P,A,O,N,C,V,D;!((a=t.data)!=null&&a.checkout)||!((p=(u=t.data)==null?void 0:u.checkout)!=null&&p.email)||fetch(k,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({identifier:s.storeId,shop:o.data.shop.myshopifyDomain,customer:r==null?void 0:r.customerId,type:"Started checkout",clientId:t.clientId,pageTitle:t.context.document.title,pageUrl:t.context.document.location.href,checkoutStarted:{lineItems:t.data.checkout.lineItems.map(c=>{var E,w,L,U;return{quantity:c.quantity,productTitle:c.title,productId:((E=c.variant)==null?void 0:E.product.id)||"",variantId:((w=c.variant)==null?void 0:w.id)||"",sku:(L=c.variant)==null?void 0:L.sku,vendor:((U=c.variant)==null?void 0:U.product.vendor)||""}}),attributes:t.data.checkout.attributes,address1:(n=t.data.checkout.shippingAddress)==null?void 0:n.address1,address2:(h=t.data.checkout.shippingAddress)==null?void 0:h.address2,city:(l=t.data.checkout.shippingAddress)==null?void 0:l.city,country:(f=t.data.checkout.shippingAddress)==null?void 0:f.country,province:(g=t.data.checkout.shippingAddress)==null?void 0:g.province,zip:(I=t.data.checkout.shippingAddress)==null?void 0:I.zip,email:t.data.checkout.email||"",phone:t.data.checkout.phone||"",firstName:((T=t.data.checkout.shippingAddress)==null?void 0:T.firstName)||"",lastName:((S=t.data.checkout.shippingAddress)==null?void 0:S.lastName)||"",currencyCode:t.data.checkout.currencyCode,totalDiscount:((_=t.data.checkout.discountsAmount)==null?void 0:_.amount)||0,totalPrice:((x=t.data.checkout.totalPrice)==null?void 0:x.amount)||0,orderId:((P=t.data.checkout.order)==null?void 0:P.id)||"",shopifyCustomerId:((O=(A=t.data.checkout.order)==null?void 0:A.customer)==null?void 0:O.id)||"",shippingHandle:t.data.checkout.delivery&&((N=t.data.checkout.delivery)==null?void 0:N.selectedDeliveryOptions.length)>0?(C=t.data.checkout.delivery)==null?void 0:C.selectedDeliveryOptions[0].title:"",shippingType:t.data.checkout.delivery&&((V=t.data.checkout.delivery)==null?void 0:V.selectedDeliveryOptions.length)>0?(D=t.data.checkout.delivery)==null?void 0:D.selectedDeliveryOptions[0].type:"",checkoutToken:t.data.checkout.token}}),keepalive:!0}).then(c=>c.json()).then(c=>{r!=null&&r.customerId||d.localStorage.setItem("pushup_subscriber",JSON.stringify(z(q({},r),{customerId:c.customer._id,email:c.customer.email||"",phone:c.customer.phone||"",isEmailSubscribed:!0})))})};e.subscribe("checkout_started",t=>{i(t)}),e.subscribe("checkout_address_info_submitted",t=>{i(t)}),e.subscribe("checkout_contact_info_submitted",t=>{i(t)}),e.subscribe("checkout_shipping_info_submitted",t=>{i(t)})}));})();
